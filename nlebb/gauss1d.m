function [pts, wts] = gauss1d(nqp, x1, x2)

nqp = min(nqp, 7);

% weight - wi 	    abscissa - xi
if (nqp == 1)
    gp = [ 2.0 	0.0];
elseif (nqp == 2)
    gp = [
        1.0000000000000000 	-0.5773502691896257;
 	    1.0000000000000000 	0.5773502691896257 ];
elseif (nqp == 3)
    gp = [ 
        0.8888888888888888 	0.0000000000000000;
 	    0.5555555555555556 	-0.7745966692414834;
 	    0.5555555555555556 	0.7745966692414834 ];
elseif (nqp == 4)
    gp = [    
        0.6521451548625461 	-0.3399810435848563;
 	    0.6521451548625461 	0.3399810435848563;
 	    0.3478548451374538 	-0.8611363115940526;
 	    0.3478548451374538 	0.8611363115940526 ];
elseif (nqp == 5)
    gp = [
        0.5688888888888889 	0.0000000000000000;
        0.4786286704993665 	-0.5384693101056831;
        0.4786286704993665 	0.5384693101056831;
        0.2369268850561891 	-0.9061798459386640;
        0.2369268850561891 	0.9061798459386640 ];
elseif (nqp == 6)
    gp = [
        0.3607615730481386 	0.6612093864662645;
 	    0.3607615730481386 	-0.6612093864662645;
 	    0.4679139345726910 	-0.2386191860831969;
 	    0.4679139345726910 	0.2386191860831969;
	    0.1713244923791704 	-0.9324695142031521;
     	0.1713244923791704 	0.9324695142031521 ];
elseif (nqp == 7)
    gp = [
        0.4179591836734694 	0.0000000000000000;
 	    0.3818300505051189 	0.4058451513773972;
 	    0.3818300505051189 	-0.4058451513773972;
 	    0.2797053914892766 	-0.7415311855993945;
 	    0.2797053914892766 	0.7415311855993945;
 	    0.1294849661688697 	-0.9491079123427585;
     	0.1294849661688697 	0.9491079123427585 ];    
end

wts = gp(:,1);
pts = gp(:,2);
[pts, ids] = sort(pts);
wts = wts(ids);

if (nargin == 3)
    wts = wts / 2 * (x2-x1);
    pts = (x1 * (1-pts) + x2 * (1+pts)) / 2;
end

end

